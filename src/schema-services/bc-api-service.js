const { wrapSchema, introspectSchema } = require("@graphql-tools/wrap");
const { makeRemoteExecutor } = require("../lib");

// Need new bearer token after it's expired
const executor = makeRemoteExecutor(
  "https://api-test.bridgecrest.com/graphql",
  {
    Authorization:
      "Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsIng1dCI6IjJaUXBKM1VwYmpBWVhZR2FYRUpsOGxWMFRPSSIsImtpZCI6IjJaUXBKM1VwYmpBWVhZR2FYRUpsOGxWMFRPSSJ9.eyJhdWQiOiJlZjZhZWZlYi1lMzVkLTQ1MDctYWE2Mi0zZmFlNTc1YjgyYzkiLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC8xYWZmMDY2OS1lZTVmLTQwYjgtOTgwMC1iNWVjNGYzOWM0OGUvIiwiaWF0IjoxNjU4MjQxNTY3LCJuYmYiOjE2NTgyNDE1NjcsImV4cCI6MTY1ODI0NTQ2NywiYWlvIjoiRTJaZ1lGRHZGMHd1Vm5qNzYvbTBFRVllMCtCN0FBPT0iLCJhcHBpZCI6IjU1ZjEwYmE1LWJlMmQtNDMwMy1iZjFmLTEyZmI2MTZiYTMyZCIsImFwcGlkYWNyIjoiMSIsImlkcCI6Imh0dHBzOi8vc3RzLndpbmRvd3MubmV0LzFhZmYwNjY5LWVlNWYtNDBiOC05ODAwLWI1ZWM0ZjM5YzQ4ZS8iLCJvaWQiOiI5MjdjMTE4Ny1kYjk0LTQzYjEtOGQyOC0xZmEzNTJmMGM2NDUiLCJyaCI6IjAuQVc0QWFRYl9HbF91dUVDWUFMWHNUem5FanV2dmF1OWQ0d2RGcW1JX3JsZGJnc2x1QUFBLiIsInJvbGVzIjpbIkFjY291bnRfb2M6RHJpdmVUaW1lX2xwOkRyaXZlVGltZV9zcDpEcml2ZVRpbWUiLCJBY2NvdW50X29jOkdPRklOQU5DSUFMX2xwOkdPRklOQU5DSUFMX3NwOkRyaXZlVGltZSIsIkFjY291bnRfb2M6Q0FSVkFOQV9scDpHT0ZJTkFOQ0lBTF9zcDpEcml2ZVRpbWUiLCJBY2NvdW50X29jOkNBUlZBTkFfbHA6QWxseV9zcDpEcml2ZVRpbWUiLCJBY2NvdW50U3RhdHVzX0FMTCIsIkFjY291bnRfb2M6RHJpdmVUaW1lX2xwOkFsbHlfc3A6RHJpdmVUaW1lIiwiQWNjb3VudF9vYzpEcml2ZVRpbWVfbHA6U2N1c2Ffc3A6U2N1c2EiLCJBY2NvdW50X29jOkdvRmlfbHA6R09GSU5BTkNJQUxfc3A6RHJpdmVUaW1lIl0sInN1YiI6IjkyN2MxMTg3LWRiOTQtNDNiMS04ZDI4LTFmYTM1MmYwYzY0NSIsInRpZCI6IjFhZmYwNjY5LWVlNWYtNDBiOC05ODAwLWI1ZWM0ZjM5YzQ4ZSIsInV0aSI6ImVmMGtJVUNXNlVDV2FOYzVMZHBjQUEiLCJ2ZXIiOiIxLjAifQ.LzmFg6UUaaDbgGjOFiS-BUEkTA0p3MY4tdooSeXy3dV3ZsDS-tWu0cUuTA2alEzReUCZQgqUgRzqp-G1S73LGS07AE2BgNhZNUZ1b-XTTcFDE42UfriEiyQofNuvitU25pBPez13LtrR6ZM8PN9KVwjtk4ZI5YZkQUTalo92rvgtci-7OPg1XwklKRI3qGzAH_gWRYoyw6PdQDg6NpMjje53KXiG2edTYeSQy0GsGP3gJZ_P_PZ9mWijQ3W22Dw_iEF8qld_ESIy5AbKVbmzwU1aptrmYtlbu6GoY8fSwM9xnkNlowqRlxVzgtQ_JUnIvfnJRKeiYkks8qBbWkSG2w",
  }
);

const generateBcApiSchema = async function() {
    return await wrapSchema({
        schema: await introspectSchema(executor),
        executor,
        transforms: [],
        // wrapSchema can use transforms to rename query name. Possibly can be used to match BC API queries to the current BFF queries
        // https://www.graphql-tools.com/docs/schema-wrapping
    });
}

module.exports = generateBcApiSchema;
